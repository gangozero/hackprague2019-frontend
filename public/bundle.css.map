{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/components/Map.svelte",
    "../src/components/Profiles.svelte"
  ],
  "sourcesContent": [
    "<script>\nimport { onMount } from 'svelte';\nimport {callAPI} from './../helpers';\nimport {category,personal,mode,edit} from './../state';\n\nimport L from \"leaflet\";\nimport  \"leaflet.heat\";\n\nexport let lat = 0;\nexport let lon = 0;\nexport let zoom = 10;\n\nlet map = null;\n\n\nlet hlayers = [];\nconst load_heatmap = () => {\n    if(map === null) return false;\n    hlayers.forEach(l=>map.removeLayer(l));\n    hlayers = [];\n\n    let catlist = [];\n    \n    if($category instanceof Array) \n        catlist = $category;\n    else\n        catlist = [$category];\n\n    catlist.forEach((ctgry)=>{\n        callAPI(`grade/${ctgry}${utype}`).then(data => {\n            let positive = [];\n            let negative = [];\n            data.forEach((item)=>{\n                if(item.grade == 1)\n                    positive.push([item.lat,item.lon,0.7])\n                else\n                    negative.push([item.lat,item.lon,0.7])\n            });\n            hlayers.push(L.heatLayer(positive, {radius: getRadius(map.getZoom()), gradient:{1: 'lime'}}));\n            hlayers.push(L.heatLayer(negative, {radius: getRadius(map.getZoom()), gradient:{1: 'red'}}));\n\n            hlayers.forEach(l=>l.addTo(map));\n        });\n    });\n} \n\n\n\nlet utype = '1';\npersonal.subscribe((v)=>{\n    if(v)\n        utype = '/1';\n    else\n        utype='';\n});\n\ncategory.subscribe(v=>{\n    load_heatmap();\n});\n\n\n///api/v1/grade/06c711ef-fb86-41b9-b0c3-358fbe376ea9/user1\n\n\nonMount(() => {\n\tmap = L.map('map');\n    map.setView([lat, lon], zoom);\n    map.on('click', e=>{\n        if(!$edit) return false;\n\n        let sample ={\n            lat: e.latlng.lat,\n            lon: e.latlng.lng,\n            grade: ($mode ? 1 : -1),\n            user_id: ($personal ? '1' : 'user_'+Math.round(Math.random()*100))\n        }\n        callAPI(`grade/${$category}`,sample).then(v=>load_heatmap(map));\n    });\n    map.on('zoomend', e=>{\n        hlayers.forEach(l=>l.setOptions({radius: getRadius(map.getZoom())}).redraw());\n    });\n\n    let attribution = 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, , Imagery Â© <a href=\"https://here.com\">HERE</a>';\n    \n    //var tiles = 'http://tilessputnik.ru/{z}/{x}/{y}.png?tag=retina';\n    var tiles = 'https://1.base.maps.api.here.com/maptile/2.1/maptile/newest/normal.day/{z}/{x}/{y}/512/png8?app_id=7jXO4KhVfvmyfZm14F5q&app_code=Z9MDX6xk1BUHuWUlB4os5A';\n    \n    L.tileLayer(tiles, {\n    maxZoom: 18,\n    attribution: attribution\n    }).addTo(map);\n    load_heatmap();\n});\n\nfunction getRadius(currentZoom){\n    var radius;\n    if (currentZoom === 7){\n        radius=2\n    }\n    else if (currentZoom === 8) {\n        radius = 4;\n    }\n    else if (currentZoom === 9) {\n        radius = 6;\n    }\n    else if (currentZoom === 10) {\n        radius = 8;\n    }\n    else if (currentZoom === 11) {\n        radius = 10;\n    }\n    else if (currentZoom === 12) {\n        radius = 12;\n    }\n    else if (currentZoom === 13) {\n        radius = 14;\n    }\n    else if (currentZoom === 14) {\n        radius = 16;\n    }\n    else if (currentZoom === 15) {\n        radius = 18;\n    }\n    else if (currentZoom === 16) {\n        radius = 20;\n    }\n    else if (currentZoom === 17) {\n        radius = 22;\n    }\n    else if (currentZoom === 18) {\n        radius = 24;\n    }\n    return radius;\n}  \n</script>\n\n<style>\n    #map{\n        height:100%;\n        width:100%;\n    }\n</style>\n\n<div id=\"map\"></div>",
    "<script>\n\nimport { onMount } from 'svelte';\nimport {callAPI} from './../helpers';\nimport {category,personal,mode,edit} from './../state';\n\nlet listCall = callAPI('profile');\n\ncategory.subscribe(v=>console.log(v));\npersonal.subscribe(v=>console.log(v));\nmode.subscribe(v=>console.log(v));\n\n/*\nonMount(() => {\n    callAPI('profile').then((data)=>{\n        console.log(data);\n    });\n});*/\n\n</script>\n\n<style>\n#list{\n    background-color: white;\n    border:1px solid black;\n    border-radius: 5px;\n    width: 2    00px;\n    position: absolute;\n    top: 15px;\n    right: 15px;\n    z-index:100000;\n    padding:15px;\n}\n\nh3{\n    margin:2px;\n}\n\n</style>\n\n<div id=\"list\">\n    <h3>Type</h3>\n    <select bind:value={$personal}>\n        <option value={true}>Personal</option>\n        <option value={false}>Collective</option>\n    </select>\n\n    {#if $edit}\n    <select bind:value={$mode}>\n        <option value={true}>+1</option>\n        <option value={false}>-1</option>\n    </select>\n    {/if}\n\n    <h3>Category</h3>\n    {#await listCall}\n        Loading\n    {:then list}\n    {#if $edit}\n        {#each list as item}\n            <div><input type=\"radio\" bind:group={$category} value=\"{item.id}\"> {item.name}</div>\n        {/each}\n    {:else}\n        {#each list as item}\n            <div><input type=\"checkbox\" bind:group={$category} value=\"{item.id}\"> {item.name}</div>\n        {/each}\n    {/if}\n    {/await}\n        \n</div>"
  ],
  "names": [],
  "mappings": "AAyII,mBAAI,CAAC,AACD,OAAO,IAAI,CACX,MAAM,IAAI,AACd,CAAC;ACtHL,oBAAK,CAAC,AACF,gBAAgB,CAAE,KAAK,CACvB,OAAO,GAAG,CAAC,KAAK,CAAC,KAAK,CACtB,aAAa,CAAE,GAAG,CAClB,KAAK,CAAE,CAAC,IAAI,IAAI,CAChB,QAAQ,CAAE,QAAQ,CAClB,GAAG,CAAE,IAAI,CACT,KAAK,CAAE,IAAI,CACX,QAAQ,MAAM,CACd,QAAQ,IAAI,AAChB,CAAC,AAED,iBAAE,CAAC,AACC,OAAO,GAAG,AACd,CAAC"
}